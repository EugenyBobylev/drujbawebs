## drujbawebs
Здесь будут находиться части html для webapp

#### requirements
```bash
pip install --upgrade pip
pip install aiogram
pip install python-dotenv
pip install fastapi
pip install uvicorn
pip install SQLAlchemy
pip install psycopg2-binary
pip install alembic
pip install pytest
pip install pytest-asyncio
pip install requests
pip install jinja2
pip install telethon
```

**Create new Revision**
```shell
alembic revision --autogenerate -m "..."
```
**Running migration:**
```shell
alembic upgrade head
```
**Running uvicorn:**
```shell
uvicorn backend.api:app --forwarded-allow-ips='*' --uds /tmp/uvicorn.sock
```


#### Ближашие задачи

1. **Для триал пользователя реализовать:**
   - ~~возможность редактирование пробного сбора (bot+api+webapp)~~
   - ~~отображение список участвующих в сборе (db+bot+api+webapp)~~
   - формирование списка уведомления (db)
   - отображение списка уведомлений (bot+api+webapp)
   - ~~присоединение к сбору новых участников (донор) (db+bot+?)~~
2. **Общие задачи:**
   - ~~реализовать формирование ссылки на сбор (db)~~
   - ~~реализовать разбор аргументов в команде **/start** (bot)~~ 
   - ~~реализовать "Присоединение к сбору" (bot)~~
   - ~~интегрировать решение по созданию чата для сбора (bot+telethon)~~
3. **Для посетителя реализовать:**
   - регистрацию компании + ссылка на компанию (db+bot+api+webapp)  
4. **Платежка реализовать:**
   - ~~отображение экрана выбора пакета услуг (bot+?)~~
   - ~~отображение экрана перехода к оплате (bot+?)~~
   - ~~оплату услуг (CloudPayments+db+?)~~
   - ~~отображение экранов результата оплаты (db+bot)~~
5. **Интеграция красивых web app**
   - здесь будет список webb app, которые надо интегрировать (api) 
6. **Для пользователя после оплаты реализовать:**
   - ~~экран главного меню (bot+?)~~ 
   - ~~экран с выбором открытых сборов (db+bot)~~
   - экран с выбором закрытых сборов (db+bot)
   - ~~возможность редактирования анкеты пользователя (bot+api+webapp)~~
7. **Для компании реализовать:**
   - экран главного меню (bot+?)
   - личный кабинет... (db+bot+api+webapp) здесь пока туман
8. **Настройка сервера**
   - ~~настроить работу ASGI сервера Uvicorn через http://127.0.0.1:8000~~
   - ~~настроить автомат. запуск start_apy.py после перезагрузки или сбоя~~
   - настроить автомат. запуск start_bot.py после перезагрузки или сбоя
   - настроить NGINX:
     - ~~обеспечить доступ к апи по ip-address/app через https на 80-м порту~~
     - настроить отдачу статики
     - откл. доступ по http
   - ~~подключить ssl сертификаты для доменного имени~~
9. Для представителя заказчика
   - на схеме оставить только основной вариант использования, удалив все альтернативные;
   - удалить дублирующие элементы схемы;
   - пронумеровать или дать названия каждому элементу схемы;
   - определить список ролей пользователей бота (Посетитель, Пользователь, ТриалПользователь ...);
     - **Посетитель** - пользователь телеграм, не зарегистрированный в боте;
     - **ТриалПользователь** - пользователь телеграм зарегистрированный в боте, имеет аккаунт пользователя, не совершивший ни одной оплаты, имеет право на создание бесплатного сбора; 
   - на схеме обязательные поля пометить звездочками (*);
   - дать определение всех сущностей (в текстовом файле):
     - **Сбор** - это сущность содержащая информацию о торжестве (дне рождения, вечеринке, пикнике, банкете...),должн содержать следующую информацию (аттрибуты сущности):
       - \**Тип события* - описывает повод торжества, как то ДР, юбилей, свадьба, кристины... текст длиной до 200 симв, не должен быть пустым или состоять из пробелов;
       - \**Кому собираем* - описывает персону "виновника торжества", например Иванов Леха, гл.бухгалтер, тетя Люся... текст длиной до 100 не должен быть пустым или состоять из пробелов;
       - \**Дата события* - дата повода для торжества как то дата дня рождения, дата пикника, дата в формате *dd.mm.yyyy* 12.07.2023 поле не может быть пустым;
       - ...
       - *Дата поздравления* - дата фактического проведения торжества, может отличаться от значения в поле *Дата события* это дата в формате *dd.mm.yyyy*;
       - 
   - на схеме сущности и их аттрибуты должны отображаться точно так же как и в описании сущностей;
   - **описать бизнес процессы для каждой роли от точки входа в бот до завершения**, описание должно содержать в том числе последовательность перехода между элементами графической схемы в текстовом файле
10. Другое

Тарифы:
1. Пробный тариф - бесплатный при первом входе
2. Знакомый - от 1 до 5 сборов 250 ₽ за сбор
3. Приятель - от 6 до 49 сборов 200 ₽ за сбор
4. Напарник-  от 50 до 99 150 ₽ за сбор
5. Лучший друг - от 100 сборов и более 100 ₽ за сбор

Вывод в блоке tg-8:
Сейчас у вас подключен тариф: <название тарифа из списка выше>
Тариф в этом блоке выводится тот, который был последний оплачен, либо Пробный тариф если оплат еще не было

Доступные сборы: <количество доступных к созданию сборов> ( бесплатных или оплаченных)